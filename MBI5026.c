#include <mega128.h>
#include <delay.h>

//***************************************************************************************
//Обмiн данними з MBI5026
//***************************************************************************************
//****************************************************************************************
#define LE           PORTD.6  // 
#define OE           PORTD.4  // 
#define SCLK         PORTD.7  //
#define SDI          PORTD.5  //
//****************************************************************************************
//=================================================================
void send_data_MBI5026 (unsigned int data)
{
unsigned int mask=32768;
    LE=0;
    OE=1;  
    do
    {   
        SCLK=0;
        delay_us(10);
        if (data & mask) {SDI=1;}
        else  {SDI=0;};
        delay_us(10);
        SCLK=1;
        delay_us(20);
        mask>>=1;
    }
    while (mask);
    LE=1;
    delay_us(50);
    OE=0;
}
//=================================================================